Recall the definition of a Fourier transform.

\inputleannode{def:Fourier-Transform}

The following computational result will be of use later on.

\begin{lemma}\label{lemma:Gaussian-Fourier}\uses{def:Fourier-Transform}
  \begin{equation}
    \mathcal{F}(e^{\pi i \|x\|^2 z})(y) = z^{-4}\,e^{\pi i \|y\|^2 \,(\frac{-1}{z}) }.
  \end{equation}
\end{lemma}
\begin{proof}
  \todo{Fill in proof.}
\end{proof}

Of great interest to us will be a specific family of functions, known as Schwartz Functions. The Fourier transform behaves particularly well when acting on Schwartz functions. We elaborate in the following subsections.

\subsection{On Schwartz Functions}

\inputleannode{def:Schwartz-Space}

\inputleannode{lemma:Fourier-transform-is-automorphism}


% Consider adding an example for expository effect (really not necessary, would be nice if time permits though)
Another reason we are interested in Schwartz Functions is that they behave well under infinite sums. This will be useful to us when proving the Cohn-Elkies linear programming bound.

\subsection{On the Summability of Schwartz Functions}

We begin by stating a general summability result over specific subsets of $\R^d$.

\begin{lemma}\label{lemma:inv-power-summable}
  Let $X \subset \R^d$ be a set of sphere packing centres of separation $1$ that is periodic with some lattice $\Lambda \subset \R^d$. Then, there exists $k \in \N$ sufficiently large such that
  \[
    \sum_{x \in X} \frac{1}{\norm{x}^{k}} < \infty.
  \]
\end{lemma}
\begin{proof}
  First, note that it does not matter how we number the (countably many) elements of the discrete set $X$: if we prove absolute convergence for one numbering, we prove absolute convergence for \emph{any} numbering. The idea will be to bound the sequence of partial sums by considering the volumes of concentric $d$-spheres of the appropriate radii (or scaled versions of a $0$-centred fundamental domain).

  \todo{Finish!}

  % Number the elements of $X$ such that $\norm{x_1} \leq \norm{x_2} \leq \ldots$, and for all $R \in \N$, let $N_R$ be the largest index such that $\norm{x_{N_R}} \leq R$ (which exists because there can only be finitely many elements of $X$ in any ball of radius $R$). Define $S_R := \sum_{j=1}^{N_R} \norm{x_j}^{-k}$. If we can show that $S_R$ is a Cauchy sequence, we can show that $S_R$ (and therefore, $\sum_{j=1}^{\infty} \norm{x_j}^{-k}$) is convergent.

  % Fix $\eps > 0$. We need to find an $R \in \N$ such that for all $R < R_1 < R_2 \in \N$, $S_{R_2} - S_{R_1} < \eps$. We have that
  % \[
  %   0 \leq \sum_{j=N_{R_1}}^{N_{R_2}} \frac{1}{\norm{x_j}^k} \leq \frac{\Vol{\B_d(0, R_2)} - \Vol{B_d(0, R_1)}}{R_1^k} \leq \frac{c R_2^{d}}{R_1^k}
  % \]
  % for all $R > 1$. Then, for $k = d + 1$ (similarly for any $k > d$), we have some $c$ such that
  % \[
  %   0 \leq S_R \leq \frac{c}{R} \xrightarrow{R \to \infty} 0
  % \]
\end{proof}

The decaying property of Schwartz functions means that they can be compared to the absolutely convergent power series above.

\begin{lemma}\label{lemma:Schwartz-summable}\uses{def:Schwartz-Space}
  Let $f : \R^d \to \C$ be a Schwartz function and let $X \subset \R^d$ be periodic with respect to some lattice $\Lambda \subset \R^d$. Then,
  \[
    \sum_{x \in X} |f(x)| < \infty.
  \]
\end{lemma}
\begin{proof}
  Without loss of generality, assume that $0 \notin X$: if $0 \in X$, then we can add the $f(0)$ term to the sum over nonzero elements of $X$, which, if the sum over the nonzero elements converges absolutely, will be equal to the sum over all of $X$. Now, we know that for all $k \in \N$, there exists some constant $C$ such that $|f(x)| \leq C\norm{x}^{-k}$ for all $x \in \R^d$. Choosing $k$ to be sufficiently large, we see that
  \[
    \sum_{x \in X} |f(x)| \leq \sum_{x \in X} \frac{C}{\norm{x}^{k}} = C \sum_{x \in X} \frac{1}{\norm{x}^k} < \infty.
  \]
\end{proof}

We end with a crucial result on Schwartz functions, the statement of which only makes sense because of the above result.
% Should probably include something about multiplying a Schwartz function by a negative exponential, either saying that the result is Schwartz (??) or by saying that it is summable. Both would be enough to make the RHS of the sum below converge absolutely.
\inputleannode{thm:Poisson-summation-formula}


While the Poisson Summation Formula over lattices can be stated in greater generality (and probably should be formalised as such in Mathlib due to the many applications it admits), we stick with Schwartz functions because that should be sufficient for our purposes.

Later, we will use Theorem \ref{thm:Poisson-summation-formula} to prove that the certain functions $a(x)$ and $b(x)$ that will be defined later are eigenfunctions of the Fourier transform.
To apply the theorem, we need to show that these functions are Schwartz functions. We will do so by verifying the following sufficient condition.

\begin{theorem}\label{thm:smooth-fast-decay-schwartz}
    Assume $f : \R \to \C$ is smooth on $[0, \infty)$ and for all $k, n \in \N$, there exists $C \in \R$ such that
    $$
    x^{\frac{k}{2}} \cdot |f^{(n)}(x)| \leq C.
    $$
    Then, for all $d \in \N$, the function
    $$
    f_d : \R^d \to \C, \quad f_d(x) := f(\|x\|^2)
    $$
    is a Schwartz function.
\end{theorem}
