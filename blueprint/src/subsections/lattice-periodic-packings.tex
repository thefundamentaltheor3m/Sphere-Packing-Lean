\subsection{Lattices and Periodic packings}

We begin by defining what a lattice is in Euclidean space.

\begin{definition}\label{IsZLattice}\lean{IsZLattice}\leanok
  We say that an additive subgroup $\Lambda \leq \R^d$ is a \emph{lattice} if it is discrete and its $\R$-span contains all the elements of $\R^d$.
\end{definition}

There is also a corresponding dual notion, which will become relevant when we start doing Fourier analysis on functions over lattices.

\begin{definition}\label{def:dual-lattice}\lean{LinearMap.BilinForm.dualSubmodule}\leanok%\lean{def:dual-lattice}\leanok
  The \emph{dual lattice} of a lattice $\Lambda$ is the set
  \[ \Lambda^* := \setof{v \in \R^d}{\forall l \in \Lambda, \left\langle v,l \right\rangle \in \Z} \]
\end{definition}

% As one might expect,
% \begin{theorem}\label{thm:dual-lattice-is-lattice}\uses{def:dual-lattice}%\lean{thm:dual-lattice-is-lattice}
%   The dual of a lattice is also a lattice.
% \end{theorem}
% \begin{proof}
%   Let $\Lambda$ be a lattice and $\Lambda^*$ its dual. We need to show three things: that $\Lambda^*$ is an additive subgroup of $\R^d$; that $\Lambda^*$ is discrete; and that the $\R$-span of $\Lambda^*$ contains all of $\R^d$.

%   It is easy enough to see that $\Lambda^*$ is an additive subgroup of $\R^d$: it clearly contains the zero vector (whose inner-product with any vector is zero), and is closed under addition and negation because the inner-product is bilinear and $\Z$ is closed under addition and negation.
% \end{proof}

We can now define periodic sphere packings.

\begin{definition}\label{PeriodicSpherePacking}\lean{PeriodicSpherePacking}\uses{SpherePacking, IsZLattice}\leanok
  We say that a sphere packing $\Pa(X)$ is ($\Lambda$-)\emph{periodic} if there exists a lattice $\Lambda \subset \R^d$ such that for all $x \in X$ and $y \in \Lambda$, $x + y \in X$ (ie, $X$ is $\Lambda$-periodic).
\end{definition}

% \begin{lemma}\label{PeriodicSpherePacking.instAddAction}\lean{PeriodicSpherePacking.instAddAction}\uses{PeriodicSpherePacking}\leanok
%   If $\Pa(X)$ is a $\Lambda$-periodic sphere packing, then $\Lambda$ acts on $X$ by translation.
% \end{lemma}
% \begin{proof}\leanok
%   This is immediate from the definition of a periodic sphere packing.
% \end{proof}

There is a natural definition of density for periodic sphere packings, namely the ``local'' density of balls in a fundamental domain. However, \textit{a priori} the density of sphere packing above need not to coincide with this alternative definition. In \cref{theorem:psp-density}, we will prove that this is the case.

Now that we have simplified the process of computing the packing densities of specific packings, we can simplify that of computing the sphere packing constant. It turns out that once again, periodicity is key.

\begin{definition}\label{def:Periodic-sphere-packing-constant}\uses{SpherePacking.density, PeriodicSpherePacking}\notready
    The periodic sphere packing constant is defined to be
    $$ \Delta_{d}^{\text{periodic}} := \sup_{\substack{P \subset \R^d \\ \text{periodic packing}}} \Delta_P$$
\end{definition}

\begin{theorem}\label{periodic-packing-optimal}\uses{SpherePacking.density, def:Periodic-sphere-packing-constant}\notready
    For all $d$, the periodic sphere packing constant in $\R^d$ is equal to the sphere packing constant in $\R^d$.
\end{theorem}
\begin{proof}
  \todo{State this in Lean (ready).}
  \todo{Fill in proof here (see~\cite[Appendix A]{ElkiesCohn})}
\end{proof}

Thus, one can show a sphere packing to be optimal by showing its density to be equal to the \emph{periodic} sphere packing constant instead of the regular sphere packing constant. The determination of the periodic constant is easier than that of the general constant, as we shall see when investigating the Linear Programming bounds derived by Cohn and Elkies in~\cite{ElkiesCohn}.
